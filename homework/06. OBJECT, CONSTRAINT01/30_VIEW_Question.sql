--뷰 이름은 자유
--1) 학생의 평점 4.5 만점으로 환산된 정보를 검색할 수 있는 뷰를 생성하세요.
CREATE VIEW V_STUDENT_CONVERT_AVR(
	STUDENT_NUM,
	STUDENT_NAME,
	STUDENT_CONVERT_AVR
)AS(
	SELECT SNO
		 , SNAME
		 , ROUND(AVR * 4.5 / 4.0, 2)
	FROM STUDENT
);

SELECT *
FROM V_STUDENT_CONVERT_AVR;

--2) 각 과목별 기말고사 평균 점수를 검색할 수 있는 뷰를 생성하세요.

CREATE VIEW V_COURSE_SUBJECT_AVG(
	COURSE_NUM,
	COURSE_NAME,
	COURSE_SCORE_AVG
)AS(
	SELECT C.CNO
		 , C.CNAME
		 , ROUND(AVG(SC.RESULT), 2)
	FROM COURSE C
	JOIN SCORE SC
	ON SC.CNO = C.CNO
	GROUP BY C.CNO, C.CNAME
);


SELECT *
FROM V_COURSE_SUBJECT_AVG;

--3) 각 사원과 관리자(MGR)의 이름을 검색할 수 있는 뷰를 생성하세요.
CREATE VIEW V_EMPLOYEE_MANAGER_NAME(
	EMPLOYEE_NUMBER,
	EMPLOYEE_NAME,
	MANAGER_NUMBER,
	MANAGER_NAME
)AS(
	SELECT E.ENO
		 , E.ENAME
		 , E.MGR
		 , EE.ENAME
	FROM EMP E
	JOIN EMP EE
	ON E.MGR = EE.ENO
);

SELECT *
FROM V_EMPLOYEE_MANAGER_NAME;


--4) 각 과목별 기말고사 평가 등급(A~F)까지와 해당 학생 정보를 검색할 수 있는 뷰를 생성하세요.
CREATE VIEW V_COURSE_GRADE_STUDENT(
	COURSE_NUM,
	COURSE_NAME,
	SCORE_GRADE,
	STUDENT_NUM,
	STUDENT_NAME
)AS(
	SELECT C.CNO
		 , C.CNAME
		 , SCG.GRADE
		 , ST.SNO
		 , ST.SNAME
	FROM COURSE C
	JOIN SCORE SC
	ON C.CNO = SC.CNO
	JOIN STUDENT ST
	ON ST.SNO = SC.SNO
	JOIN SCGRADE SCG
	ON SC.RESULT BETWEEN SCG.LOSCORE AND SCG.HISCORE
);

SELECT *
FROM V_COURSE_GRADE_STUDENT;

--5) 물리학과 교수의 과목을 수강하는 학생의 명단을 검색할 뷰를 생성하세요.

CREATE VIEW V_PHY_PROFESSOR_STUDENT(
	PROFESSOR_NUM,
	PROFESSOR_NAME,
	COURSE_NUM,
	COURSE_NAME,
	STUDENT_NUM,
	STUDENT_NAME
)AS(
	SELECT P.PNO
		 , P.PNAME
		 , C.CNO
		 , C.CNAME
		 , ST.SNO
		 , ST.SNAME
	FROM PROFESSOR P
	JOIN COURSE C
	ON C.PNO = P.PNO
	JOIN SCORE SC
	ON SC.CNO = C.CNO
	JOIN STUDENT ST
	ON ST.SNO = SC.SNO
	WHERE P.SECTION = '물리'
);

SELECT *
FROM V_PHY_PROFESSOR_STUDENT;
















